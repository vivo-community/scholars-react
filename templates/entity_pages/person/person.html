<%= javascriptTag("person.js") %>
<%
  let person = data["personById"]
%>

<div class="container">

   <aside>
         <vivo-sidebar>
            <%= if (person["thumbnail"]) { %>
            <img class="profile-image" src="http://openvivo.org<%= person["thumbnail"] %>" />
            <% } else { %>
            <img class="profile-image" src="<%= assetPath("images/profile_picture_u39_a.png") %>" />
            <% } %>
            <vivo-sidebar-item>
               <h4 slot="heading">Contact</h4>
               <div slot="content">
                  <div>
                     <span class="label">Email</span>
                     <span class="data"><%= person["primaryEmail"] %></span>
                  </div>
                  <div>
                     <span class="label">Telephone</span>
                     <span class="data"><%= person["phone"] %></span>
                  </div>
                  <div class="address-block">
                     <span class="label">Address 1</span>
                  </div>
               </div>
            </vivo-sidebar-item>
            <vivo-sidebar-item>
               <h4 slot="heading">Professional Links</h4>
               <div slot="content">
                  <%= for (w) in person["websites"] { %>
                  <div class="website">
                     <a class="prof-link" href="<%= w["url"] %>">
                        <%= w["label"] %>
                     </a>
                  </div>
                  <% } %>
               </div>
            </vivo-sidebar-item>
         </vivo-sidebar>
     </aside>

      <main>
         <h1 class="profile-name"><%= person["name"] %></h1>
         <h2 class="preferred-title"><%= person["preferredTitle"] %></h2>
         <!-- tabs -->
         <vivo-tabs>
            <vivo-tab id="about-tab" slot="tabs" selected>
               <h2>About</h2>
            </vivo-tab>
            <vivo-tab-panel id="about-panel" slot="panels" selected>
               <h4>Overview</h4>
               <div>
                  <%= raw(person["overview"]) %>
               </div>
               <h5>Current Appointments &amp; Affiliations</h5>
               <section class="positions">
                  <%= for (p) in person["positions"] { %>
                  <div class="position">
                     <span class="position-type"><%= p["label"] %></span>
                  </div>
                  <% } %>
               </section>
               <div><b>Orcid</b> <%= person["id"] %></div>
               <div><b>Scopus</b> <%= person["scopusId"] %></div>
            </vivo-tab-panel>

            <vivo-tab id="background-tab" slot="tabs">
               <h2>Background</h2>
            </vivo-tab>
            <vivo-tab-panel id="background-panel" slot="panels">
               <h4>Education & Credentials</h4>
               <h5>Education</h5>
               <section class="educations">
                  <%= for (e) in person["educationAndTraining"] { %>
                  <div class="education">
                     <span class="education-label">
                        <%= e["abbreviation"] %>
                        <%= if (e["organization"]) { %>
                          <%= e["organization"]["label"] %>
                        <% } %>
                        <%= e["field"] %>
                     </span>
                     <span>
                        <!-- should always be a start date -->
                        <%= if (e["startDate"]) { %>
                          <% let start = {"dateTime": e["startDate"], "resolution": "yearMonth"}
                          <%= FormatDateTime(start) %>
                        <% } %>
                        <%= if (e["endDate"]) { %>
                          <span> to </span>
                          <% let end = {"dateTime": e["endDate"], "resolution": "yearMonth"}
                          <%= FormatDateTime(end) %>
                        <% } %>
                     </span>
                  </div>
                  <% } %>
               </section>
            </vivo-tab-panel>

            <vivo-tab id="research-tab" slot="tabs">
               <h2>Research &amp; Expertise</h2>
            </vivo-tab>
            <vivo-tab-panel id="research-panel" slot="panels">
               <h4>Expertise</h4>
               <%= if (person["researchAreas"]) { %>
               <h5>Subject Headings</h5>
               <ul>
                  <%= for (k) in person["researchAreas"] { %>
                  <li>
                     <a href="/entities/concepts/<%= k["id"] %>">
                        <%= k["label"] %>
                     </a>
                  </li>
                  <% } %>
               </ul>
               <% } %>

               <h5 class="tab-content">Publications &amp; Artistic Works</h5>

               <vivo-publication-list>
                  <%= for (p) in person["publications"] { %>
                  <vivo-publication publication-url="/entities/publication/<%= p["id"] %>">
                     <div slot="title"><%= p["title"] %></div>
                     <div slot="abstract"><%= raw(p["abstractText"]) %></div>
                     <span slot="date"><%= FormatGraphqlDateForSitemap(p["publicationDate"]) %></span>
                     <vivo-publication-author-list slot="authors">
                        <%= for (a) in p["authors"] { %>
                        <vivo-publication-author profile-url="/entities/person/<%= a["id"] %>">
                           <%= a["label"] %>
                        </vivo-publication-author>
                        <% } %>
                     </vivo-publication-author-list>
                  </vivo-publication>
                  <% } %>
               </vivo-publication-list>
            </vivo-tab-panel>

            <vivo-tab id="teaching-tab" slot="tabs">
               <h2>Teaching &amp; Mentoring</h2>
            </vivo-tab>
            <vivo-tab-panel id="teaching-panel" slot="panels">
            </vivo-tab-panel>

            <vivo-tab id="activities-tab" slot="tabs">
               <h2>Professional Activities</h2>
            </vivo-tab>
            <vivo-tab-panel id="activities-panel" slot="panels">
            </vivo-tab-panel>

         </vivo-tabs>

      </main><!-- end col-10 -->
   
</div><!-- end container -->